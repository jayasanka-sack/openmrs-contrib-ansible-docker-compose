# Description
Run OpenMRS reference application 2.4 and mysql as disposable docker 
containers for [CIEL](https://om.rs/ciel) administration.

The docker image used was generated by OpenMRS SDK, and deployed to 
the 2.4 tag of [openmrs/openmrs-reference-application-distro](https://hub.docker.com/r/openmrs/openmrs-reference-application-distro/)
on Docker Hub.

## Building and deploying new version

Edit [openmrs-distro.properties](https://github.com/openmrs/openmrs-contrib-ansible-docker-compose/blob/master/files/cieladmin/openmrs-distro.properties)

Use the OpenMRS SDK to create Docker container within a `docker` subfolder:

```bash
mvn org.openmrs.maven.plugins:openmrs-sdk-maven-plugin:4.1.1:build-distro \
  -Ddir=docker -U
```

Build the docker image:

```bash
cd docker
docker build . -t openmrs/openmrs-reference-application-distro:2.4
```

Push the image to Docker Hub:

```bash
docker push openmrs/openmrs-reference-application-distro:2.4
```

## Running it locally

To start both containers:
```
$ BACKUP_DIR=./backups docker-compose down -v
$ BACKUP_DIR=./backups docker-compose up
```

Use _CTRL + C_ to stop it all containers. But make sure to destroy 
containers to delete any left overs volumes and data when doing changes 
to the docker configuration and images:

```
$ BACKUP_DIR=./backups docker-compose down -v
```
